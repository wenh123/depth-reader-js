{"version":3,"sources":["depth-reader.js"],"names":["parseXDM","self","imageNS","xapDescElt","extDescElt","vendorNS","getNS","devPoseNS","camPoseNS","deviceNS","cameraNS","depthNS","noiseNS","perspectNS","xdmRevElt","findChild","devVendElt","camVendElt","devPoseElt","camPoseElt","imagingElt","lastDesc","imageElt","enhDepElt","rawDepElt","confidElt","revision","attrValue","childValue","elemValue","device","vendor","manufacturer","camera","model","pose","latitude","longitude","altitude","positionX","positionY","positionZ","rotationAxisX","rotationAxisY","rotationAxisZ","rotationAngle","perspective","focalLengthX","focalLengthY","principalPointX","principalPointY","depth","metric","parseBool","format","near","far","image","mime","raw","confidence","data","parseLensBlur","focusNS","focus","focalPointX","focalPointY","focalDistance","blurAtInfinity","parseRDF","xmpXml","parser","DOMParser","xmlDoc","parseFromString","rdfDesc","firstChild","documentElement","readNS","err","Error","parent","elts","childNodes","i","length","nodeName","elt","nodeType","nextSibling","ns","name","index","getElementsByTagNameNS","textContent","getAttributeNS","makeDataURI","findMarker","buf","pos","getHeader","arr","hasHeader","header","str","baToStr","xmpXapNS","xmpExtNS","nsMap","_namespaces","attrs","attributes","prefix","uri","value","test","slice","toLowerCase","prefixes","Object","keys","j","len","subarray","String","fromCharCode","apply","a","Array","match","loadImage","src","img","Promise","resolve","reject","Image","onload","onerror","newCanvas","w","h","Canvas","canvas","document","createElement","width","height","xhrResType","XMLHttpRequest","root","this","exports","require","RSVP","DepthReader","isXDM","prototype","parseFile","buffer","bytes","Uint8Array","payload","xmpXapXml","xmpExtXml","isXap","extra","size","start","debug","call","forEach","loadFile","fileUrl","xhr","responseType","open","response","fileData","msg","status","send","normalizeDepthMap","bias","_normalized","then","ctx","getContext","drawImage","val","pcnt","norm","prev","pixels","getImageData","total","hist","Int32Array","min","max","depthThresh","spread","Math","round","putImageData","toDataURL","module"],"mappings":"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","file":"depth-reader.min.js"}