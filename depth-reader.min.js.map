{"version":3,"sources":["depth-reader.js"],"names":["parseXDM","self","imageNS","xapDescElt","extDescElt","vendorNS","getNS","devPoseNS","camPoseNS","deviceNS","cameraNS","depthNS","noiseNS","perspectNS","xdmRevElt","findChild","devVendElt","camVendElt","devPoseElt","camPoseElt","imagingElt","lastDesc","imageElt","depthElt","confidElt","revision","attrValue","childValue","elemValue","device","vendor","manufacturer","camera","model","pose","latitude","longitude","altitude","positionX","positionY","positionZ","rotationAxisX","rotationAxisY","rotationAxisZ","rotationAngle","perspective","focalLengthX","focalLengthY","principalPointX","principalPointY","depth","metric","parseBool","format","near","far","image","mime","confidence","data","parseLensBlur","focusNS","focus","focalPointX","focalPointY","focalDistance","blurAtInfinity","parseRDF","xmpXml","parser","DOMParser","xmlDoc","parseFromString","rdfDesc","firstChild","documentElement","readNS","err","Error","parent","elts","childNodes","i","length","nodeName","elt","nodeType","nextSibling","ns","name","getElementsByTagNameNS","textContent","getAttributeNS","makeDataURI","findMarker","buf","pos","getHeader","arr","hasHeader","header","str","baToStr","xmpXapNS","xmpExtNS","nsMap","_namespaces","attrs","attributes","prefix","uri","value","test","slice","toLowerCase","prefixes","Object","keys","j","len","subarray","String","fromCharCode","apply","a","Array","match","loadImage","img","src","Promise","resolve","reject","onload","newCanvas","w","h","Canvas","canvas","document","createElement","width","height","xhrResType","XMLHttpRequest","Image","root","this","exports","require","RSVP","DepthReader","isXDM","prototype","parseFile","buffer","bytes","Uint8Array","payload","xmpXapXml","xmpExtXml","isXap","extra","size","start","debug","call","loadFile","fileUrl","xhr","responseType","open","response","fileData","msg","status","send","normalizeDepthMap","bias","_normalized","then","ctx","getContext","drawImage","val","norm","prev","pixels","getImageData","min","max","spread","Math","round","putImageData","toDataURL","module"],"mappings":"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","file":"depth-reader.min.js"}